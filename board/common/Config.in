comment "Image Signing"

choice
	prompt "Signing key source"
	default SIGN_SRC_DIR

config SIGN_SRC_DIR
	bool "Directory"

config SIGN_SRC_PKCS11
	bool "PKCS#11 URL"

endchoice

config SIGN_KEY
	string "Signing key"
	default "${BR2_EXTERNAL_INFIX_PATH}/board/common/dev-key" if SIGN_SRC_DIR

comment "Additional Artifacts"

# For /etc/os-release, uses CondtionArchitechture= from systemd.unit(5)
config INFIX_ARCH
	string
	default "arm"     if BR2_arm
	default "arm64"   if BR2_aarch64
	default "mips64"  if BR2_mips64
	default "riscv64" if BR2_riscv
	default "x86_64"  if BR2_x86_64

menuconfig DISK_IMAGE
	bool "Disk image"
	help
	  Compose a full disk image with redundant firmware partitions,
	  configuration partition, etc.

	  This is useful when:
	  - Bringing up a blank system during manufacturing
	  - Creating a GNS3 appliance
	  - Developing/debugging issues in the boot process in QEMU

config DISK_IMAGE_SIZE
	string "Image size"
	depends on DISK_IMAGE
	default "512M"
	help
	  Create a disk image of this size.  A K/M/G suffix may be used
	  to multiply by powers of 1024.  Suffixes like KB/MB/GB may be
	  used to multiply by powers of 1000.  The image will be split
	  proportionally to fit the two rootfs, a kernel, a writable
	  /cfg and /var partiotions.

	  Minimum supported size is 512M.

menuconfig GNS3_APPLIANCE
	bool "GNS3 Appliance"
	select DISK_IMAGE
	default y if BR2_x86_64
	help
	  Create a GNS3 appliance description that, together with the
	  disk image, can be imported into GNS3.

config GNS3_APPLIANCE_RAM
	int "Reserved RAM (MiB)"
	depends on GNS3_APPLIANCE
	default "192"
	help
	  Amount of host RAM reserved for an appliance instance.

	  Minimum supported size is 192M.

config GNS3_APPLIANCE_IFNUM
	int "Number of interfaces"
	depends on GNS3_APPLIANCE
	default "1"
	help
	  Number of Ethernet interfaces to create for an appliance instance.

menuconfig FIT_IMAGE
	bool "Traditional FIT image"
	help
	  Create a "regular" FIT image where the kernel and DTBs are
	  stored in the FIT rather than inside the rootfs (like it
	  normally is in Infix).

	  This is useful when trying out Infix on targets whose
	  bootloader might not be capable of booting a raw Squash, but
	  is able to handle an FIT.

config FIT_ARCH
	string
	depends on FIT_IMAGE
	default "arm64" if BR2_aarch64

config FIT_KERNEL_LOAD_ADDR
	string "Kernel load address"
	depends on FIT_IMAGE

