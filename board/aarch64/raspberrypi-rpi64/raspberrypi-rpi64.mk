# The CONFIG_REGULATOR_GPIO=y is load bearing for booting the RPi4 from
# SD card, see regulator-sd-io-1v8 in bcm2711-rpi-4-b.dts for details.
define RASPBERRYPI_RPI64_LINUX_CONFIG_FIXUPS
	$(call KCONFIG_ENABLE_OPT,CONFIG_SOUND)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SND)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SND_SOC)
	$(call KCONFIG_ENABLE_OPT,CONFIG_INPUT_MOUSE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_INPUT_KEYBOARD)
	$(call KCONFIG_ENABLE_OPT,CONFIG_INPUT_TOUCHSCREEN)
	$(call KCONFIG_SET_OPT,CONFIG_INPUT_MOUSEDEV,m)
	$(call KCONFIG_SET_OPT,CONFIG_HID_GENERIC,m)

	$(call KCONFIG_ENABLE_OPT,CONFIG_ARCH_BCM)
	$(call KCONFIG_ENABLE_OPT,CONFIG_ARCH_BCM2835)
	$(call KCONFIG_ENABLE_OPT,CONFIG_ARCH_BRCMSTB)
	$(call KCONFIG_SET_OPT,CONFIG_BCM2835_MBOX,y)
	$(call KCONFIG_ENABLE_OPT,CONFIG_BCM2835_WDT)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DMA_BCM2835)
	$(call KCONFIG_ENABLE_OPT,CONFIG_RASPBERRYPI_FIRMWARE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_PINCTRL_BCM2835)
	$(call KCONFIG_ENABLE_OPT,CONFIG_GPIO_BCM2835)
	$(call KCONFIG_SET_OPT,CONFIG_BRCMFMAC,m)
	$(call KCONFIG_ENABLE_OPT,CONFIG_BRCMFMAC_SDIO)
	$(call KCONFIG_SET_OPT,CONFIG_I2C_BCM2835,m)
	$(call KCONFIG_SET_OPT,CONFIG_BCM2835_THERMAL,m)
	$(call KCONFIG_SET_OPT,CONFIG_BCM2711_THERMAL,m)
	$(call KCONFIG_ENABLE_OPT,CONFIG_MMC_BCM2835)
	$(call KCONFIG_ENABLE_OPT,CONFIG_MMC_SDHCI_IPROC)
	$(call KCONFIG_ENABLE_OPT,CONFIG_RASPBERRYPI_POWER)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SERIAL_8250)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SERIAL_8250_CONSOLE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SERIAL_8250_BCM2835AUX)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SERIAL_8250_EXTENDED)
	$(call KCONFIG_ENABLE_OPT,CONFIG_SERIAL_8250_SHARE_IRQ)
	$(call KCONFIG_ENABLE_OPT,CONFIG_NET_VENDOR_BROADCOM)
	$(call KCONFIG_SET_OPT,CONFIG_BCMGENET,y)
	$(call KCONFIG_SET_OPT,CONFIG_R8169,m)
	$(call KCONFIG_SET_OPT,CONFIG_REGULATOR_RASPBERRYPI_TOUCHSCREEN_ATTINY,m)
	$(call KCONFIG_SET_OPT,CONFIG_REGULATOR_GPIO,y)
	$(call KCONFIG_ENABLE_OPT,CONFIG_COMMON_CLK_BCM2835)
	$(call KCONFIG_ENABLE_OPT,CONFIG_CLK_RASPBERRYPI)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_KMS_HELPER)
	$(call KCONFIG_SET_OPT,CONFIG_DRM_V3D,m)
	$(call KCONFIG_SET_OPT,CONFIG_DRM_VC4,m)
	$(call KCONFIG_SET_OPT,CONFIG_STAGING,y)
	$(call KCONFIG_SET_OPT,CONFIG_SND_BCM2835,m)

	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_VC4_HDMI_CEC)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_LOAD_EDID_FIRMWARE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_PANEL_BRIDGE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_BRIDGE)
	$(call KCONFIG_SET_OPT,CONFIG_DRM_TOSHIBA_TC358762,m)
	$(call KCONFIG_SET_OPT,CONFIG_DRM_PANEL_SIMPLE,m)

	$(call KCONFIG_ENABLE_OPT,CONFIG_FB)
	$(call KCONFIG_ENABLE_OPT,CONFIG_FRAMEBUFFER_CONSOLE)
	$(call KCONFIG_ENABLE_OPT,CONFIG_FRAMEBUFFER_CONSOLE_DETECT_PRIMARY)
	$(call KCONFIG_ENABLE_OPT,CONFIG_DRM_FBDEV_EMULATION)

	$(call KCONFIG_SET_OPT,CONFIG_TOUCHSCREEN_EDT_FT5X06,m)

	$(call KCONFIG_ENABLE_OPT,CONFIG_BACKLIGHT_CLASS_DEVICE)
endef

$(eval $(ix-board))
$(eval $(generic-package))
