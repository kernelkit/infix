image boot.vfat {
	vfat {
		files = {
#BOOT_FILES#
		}
	}

	size = 32M
}

image cfg.ext4 {
	empty = true
	temporary = true
	size = 16M

	ext4 {
		label = "cfg"
	}
}

image var.ext4 {
	empty = true
	temporary = true
	size = 512M

	ext4 {
		label = "var"
		use-mke2fs = true
	}
}

image #INFIX_ID##VERSION#-rpi64-sdcard.img {
	hdimage {
		partition-table-type = "hybrid"
	}

	partition boot {
		partition-type = 0xc
		bootable = "true"
		image = "boot.vfat"
	}

	partition aux {
		partition-type-uuid = srv
		image = "aux.ext4"
	}

	partition primary {
		partition-type-uuid = linux
		bootable = "true"
		size = 250M
		image = "rootfs.squashfs"
	}

	partition secondary {
		partition-type-uuid = linux
		bootable = "true"
		size = 250M
		image = "rootfs.squashfs"
	}

	partition cfg {
		partition-type-uuid = srv
		image = "cfg.ext4"
	}

	partition var {
		partition-type-uuid = var
		image = "var.ext4"
	}
}
